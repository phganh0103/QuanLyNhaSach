<!-- Nh·∫≠p t√°c gi·∫£ -->
<h1 class="text-center text-primary mb-5 mt-5">NH·∫¨P TH√îNG TIN T√ÅC GI·∫¢ M·ªöI</h1>
<form id="post_new_author" onsubmit="addAuthors(event)">
    <table class="table table-bordered text-center align-middle">
        <thead class="table-light">
        <tr>
            <th>STT</th>
            <th>T√™n t√°c gi·∫£</th>
            <th>X√≥a</th>
        </tr>
        </thead>
        <tbody id="author-info-rows">
        <!-- Row 1 -->
        <tr>
            <td>1</td>
            <td><input type="text" class="form-control" name="author_name" placeholder="Nh·∫≠p t√™n t√°c gi·∫£" required>
            </td>
            <td>
                <button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">
                    X√≥a
                </button>
            </td>
        </tr>
        </tbody>
    </table>
    <div class="d-flex justify-content-end">
        <button type="button" class="btn btn-secondary me-2" onclick="addAuthorRow()">‚ûï Th√™m d√≤ng</button>
        <button type="submit" class="btn btn-primary">üì• X√°c nh·∫≠n nh·∫≠p th√¥ng tin t√°c gi·∫£</button>
    </div>
</form>

<script>
    function addAuthorRow() {
        const tableBody = document.getElementById('author-info-rows');
        const newRowIndex = tableBody.rows.length + 1;
        const newRow = `
    <tr>
        <td>${newRowIndex}</td>
        <td><input type="text" class="form-control" name="author_name" placeholder="Nh·∫≠p t√™n t√°c gi·∫£" required></td>
        <td>
                <button type="button" class="btn btn-danger btn-sm" onclick="deleteRow(this)">
                    X√≥a
                </button>
            </td>
    </tr>`;
        tableBody.insertAdjacentHTML('beforeend', newRow);
    }

    function addAuthors(e) {
        e.preventDefault()
        const formData = new FormData(document.getElementById('post_new_author'));
        authors = []
        formData.forEach((value) => {
            authors.push(value)
        });

        fetch('/store_manager/add_authors', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(authors)
        })
            .then(response => {
                if (response.ok) {
                    return response.json()
                } else {
                    throw new Error('Kh√¥ng th·ªÉ th√™m t√°c gi·∫£ m·ªõi!');
                }
            })
            .then(data => {
                if(data.success){
                    alert('Nh·∫≠p t√°c gi·∫£ m·ªõi th√†nh c√¥ng')
                    location.reload()
                }
                else{
                    alert(data.message)
                }
            })
            .catch(error => {
                console.error(error);
                alert('C√≥ l·ªói x·∫£y ra khi th√™m t√°c gi·∫£.');
            });
    }
</script>